<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script defer src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename = 'css/styles.css') }}">
    {% block styles %}{% endblock %}
    {% if title %}
    <title>{{ title }} - WorkingTitle</title>
    {% else %}
    <title>{{ _("Welcome to WorkingTitle") }}</title>
    {% endif %}
</head>

<body>
    <nav>
        <div class="brand">
            <!-- TODO: Add logo/brand -->
            <span>Logo</span>
        </div>
        <ul class="nav-links">
            <li>
                <a href="{{ url_for('main.index') }}">{{ _("Home") }}</a>
            </li>
            <li>
                <a href="{{ url_for('attractions.get_attractions') }}">{{ _("Attractions") }}</a>
            </li>
            {% if current_user.is_anonymous %}
            <li>
                <a href="{{ url_for('auth.login') }}">{{ _("Login") }}</a>
            </li>
            {% else %}
            <li>
                <a href="{{ url_for('auth.profile')}}">{{ current_user.username }}</a>
            </li>
            {% if current_user.is_admin %}
            <li>
                <a href="{{ url_for('admin.index') }}">{{ _("Admin") }}</a>
            <li>
            {% endif %}
                <a href="{{ url_for('auth.logout') }}">{{ _("Logout") }}</a>
            </li>
            {% endif %}
            <li>
                <a href="{{ url_for('main.language') }}">{{ _("Babel Fish") }}</a>
            </li>
            <li class="city-select">
                <form action="{{ url_for('attractions.select_city') }}" method="POST" id="cityForm">
                    {{ select_city_form.csrf_token }}
                    <select name="city" id="citySelect">
                    {% for city in select_city_form.city.choices %}
                        <option value="{{ city[0] }}">{{ city[1] }}</option>
                    {% endfor %}
                    </select>
                </form>
            </li>
        </ul>
    </nav>
    <div class="flash-messages">
        {% with messages = get_flashed_messages(with_categories=True) %}
        {% if messages %}
        <ul>
            {% for category, message in messages %}
            <li class="flask-flash {{ category }}">
                <span>{{ message | translate }}</span>
            </li>
            {% endfor %}
            <script>
                const flashMessages = document.querySelectorAll('.flask-flash');
                setTimeout(() => {
                    flashMessages.forEach(flashMessage => {
                        flashMessage.classList.add('fade-out');
                    })
                }, 5000); 
            </script>
        </ul>
        {% endif %}
        {% endwith %}
    </div>
    {% block content %}
    {% endblock %}

    <script src="{{url_for('static', filename='js/app.js')}}"></script>
    
</body>

</html>